import{al as k,am as q,a,ao as e,an as C}from"./index-D3Bzzjcr.js";function P({qnaCategoryId:f=2,onCancel:d,onSuccess:x,defaultMemberIdForTest:y=1}){const l=k(),{member:m}=q(),[r,j]=a.useState(""),[n,N]=a.useState(""),[i,v]=a.useState(!0),[u,g]=a.useState(!1),[b,p]=a.useState(""),w=m?.id??m?.memberId??y,s=a.useMemo(()=>{const t={};return(!r||r.trim().length<2)&&(t.title="제목은 2자 이상"),(!n||n.trim().length<10)&&(t.content="내용은 10자 이상"),t},[r,n]),h=Object.keys(s).length>0,S=()=>{if(d)return d();l("/boards/qna")},I=async t=>{if(t.preventDefault(),!h){g(!0),p("");try{const o={memberId:w,boardCategoryId:f,title:r.trim(),content:n.trim(),requireAdminPost:!1,isPublic:i,qnaStatus:"WAITING",postStatus:"PUBLISHED"},c=(await C.post("/boards/register",o))?.data?.id;if(x)return x(c);l(c?`/boards/qna/read/${c}`:"/boards/qna")}catch(o){console.error(o),p("등록 실패. 잠시 후 다시 시도하세요.")}finally{g(!1)}}};return e.jsxs("section",{className:"w-full max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"QnA 작성"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"궁금한 내용을 자세히 남겨주세요."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:S,className:"rounded-2xl px-4 py-2 shadow-sm ring-1 ring-gray-200 bg-white text-gray-700 hover:bg-gray-50 transition",children:"취소"}),e.jsx("button",{type:"submit",form:"qna-write-form",disabled:u||h,className:"rounded-2xl px-4 py-2 shadow-sm text-white bg-gradient-to-r from-pink-300 to-purple-300 hover:opacity-90 transition disabled:opacity-60",children:u?"등록 중…":"등록"})]})]}),e.jsxs("form",{id:"qna-write-form",onSubmit:I,className:"rounded-3xl border border-gray-200 bg-white p-5 md:p-6 shadow-sm space-y-5",children:[e.jsxs("div",{className:"md:w-56",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"공개 여부"}),e.jsx("button",{type:"button",onClick:()=>v(t=>!t),className:"w-full px-3 py-2 rounded-xl text-sm ring-1 transition "+(i?"bg-gradient-to-r from-pink-200 to-purple-200 text-gray-900 ring-transparent":"bg-white text-gray-700 ring-gray-200 hover:bg-gray-50"),title:i?"현재: 공개":"현재: 비공개",children:i?"공개":"비공개"}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"비공개 시 본인/관리자만 열람."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"제목"}),e.jsx("input",{type:"text",value:r,onChange:t=>j(t.target.value),placeholder:"예) 회원정보 수정은 어디에서 하나요?",className:`w-full rounded-xl border text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-200 ${s.title?"border-rose-300":"border-gray-200"}`,maxLength:120}),e.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.title?e.jsx("p",{className:"text-xs text-rose-600",children:s.title}):e.jsx("span",{className:"text-xs text-gray-500",children:"2~120자"}),e.jsxs("span",{className:"text-[11px] text-gray-400",children:[r.length,"/120"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"내용"}),e.jsx("textarea",{value:n,onChange:t=>N(t.target.value),placeholder:"상세한 상황/재현 방법/기대 동작 등을 적어주세요.",className:`w-full min-h-[200px] rounded-xl border text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-200 resize-y ${s.content?"border-rose-300":"border-gray-200"}`}),s.content?e.jsx("p",{className:"mt-1 text-xs text-rose-600",children:s.content}):e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"10자 이상 입력"})]}),b&&e.jsx("div",{className:"rounded-2xl bg-rose-50 text-rose-700 ring-1 ring-rose-200 px-4 py-3 text-sm",children:b})]})]})}export{P as default};
