import{al as z,am as I,a,ao as e,an as T}from"./index-D3Bzzjcr.js";function F({initialKeyword:j="",pageSizeOptions:N=[5,10,20],defaultSize:v=10,showWriteButton:w=!0,onWrite:o,onRead:c,adminMode:K=!1}){const m=z(),{member:S,loading:R,fetchMember:Y}=I(),x=S?.role==="ADMIN",[g,k]=a.useState(j),[n,D]=a.useState(v),[r,C]=a.useState(1),[u,M]=a.useState([]),[p,E]=a.useState(0),[A,h]=a.useState(!1),[y,f]=a.useState(""),i=a.useMemo(()=>Math.max(1,Math.ceil(p/n)),[p,n]),$=()=>{if(!x){alert("관리자만 공지를 등록할 수 있습니다.");return}return o?o():m("/boards/notice/write")},L=t=>c?c(t):m(`/boards/notice/read/${t}`),b=t=>{if(!t)return"-";const s=new Date(t);return Number.isNaN(s.getTime())?"-":`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`},l=async(t=1)=>{h(!0),f("");try{const s={cond:{keyword:g?.trim()||null},criteria:{page:t,size:n}},d=await T.post("/boards/notice/list",s);M(d.data?.items||[]),E(d.data?.page?.totalElements??d.data?.totalElements??0),C(t)}catch(s){console.error("공지사항 목록 조회 실패:",s),f("공지사항을 불러오지 못했습니다.")}finally{h(!1)}};a.useEffect(()=>{l(1)},[n]);const P=t=>{t.preventDefault(),l(1)};return e.jsxs("section",{className:"w-full max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"공지사항"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"메디노트의 새로운 소식과 업데이트를 확인하세요."})]}),w&&x&&e.jsx("button",{onClick:$,className:"rounded-2xl px-4 py-2 shadow-sm text-white bg-gradient-to-r from-pink-300 to-purple-300 hover:opacity-90 transition",children:"공지 등록"})]}),e.jsx("div",{className:"rounded-3xl border border-gray-200 bg-white p-4 md:p-5 shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-3",children:[e.jsx("div",{className:"ms-auto"}),e.jsx("select",{className:"rounded-xl border-gray-200 text-sm",value:n,onChange:t=>D(Number(t.target.value)),children:N.map(t=>e.jsxs("option",{value:t,children:[t,"개씩"]},t))}),e.jsxs("form",{onSubmit:P,className:"flex items-stretch gap-2",children:[e.jsx("input",{type:"text",value:g,onChange:t=>k(t.target.value),placeholder:"공지 검색 (예: 업데이트, 이벤트, 점검)",className:"rounded-xl border border-gray-200 text-sm px-3 py-2 w-56 focus:outline-none focus:ring-2 focus:ring-purple-200"}),e.jsx("button",{type:"submit",className:"rounded-2xl px-4 py-2 text-sm text-white bg-gradient-to-r from-pink-300 to-purple-300 hover:opacity-90 transition",children:"검색"})]})]})}),e.jsxs("div",{className:"rounded-3xl border border-gray-200 bg-white shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2 px-4 md:px-6 py-3 text-xs md:text-sm text-gray-500 bg-gray-50",children:[e.jsx("div",{className:"col-span-9 md:col-span-9",children:"제목"}),e.jsx("div",{className:"hidden md:block md:col-span-3 text-center",children:"작성일"})]}),A?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"불러오는 중…"}):y?e.jsx("div",{className:"p-8 text-center text-red-500",children:y}):u.length===0?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"등록된 공지사항이 없습니다."}):e.jsx("ul",{className:"divide-y divide-gray-100",children:u.map(t=>e.jsxs("li",{className:"grid grid-cols-12 gap-2 px-4 md:px-6 py-4",children:[e.jsxs("div",{className:"col-span-12 md:col-span-9",children:[e.jsx("button",{onClick:()=>L(t.id),className:"text-left text-gray-900 hover:underline",title:t.title,children:e.jsx("span",{className:"font-medium",children:t.title})}),e.jsx("div",{className:"mt-1 md:hidden text-xs text-gray-500",children:b(t.regDate)})]}),e.jsx("div",{className:"hidden md:flex md:col-span-3 items-center justify-center text-sm text-gray-600",children:b(t.regDate)})]},t.id))}),e.jsxs("div",{className:"flex items-center justify-center gap-1 p-4",children:[e.jsx("button",{onClick:()=>r>1&&l(r-1),className:"px-3 py-1.5 text-sm rounded-lg ring-1 ring-gray-200 hover:bg-gray-50 disabled:opacity-40",disabled:r<=1,children:"이전"}),Array.from({length:i},(t,s)=>s+1).map(t=>e.jsx("button",{onClick:()=>l(t),className:"px-3 py-1.5 text-sm rounded-lg ring-1 "+(t===r?"bg-gray-900 text-white ring-gray-900":"ring-gray-200 hover:bg-gray-50"),children:t},t)),e.jsx("button",{onClick:()=>r<i&&l(r+1),className:"px-3 py-1.5 text-sm rounded-lg ring-1 ring-gray-200 hover:bg-gray-50 disabled:opacity-40",disabled:r>=i,children:"다음"})]})]})]})}function q(){return e.jsx("main",{className:"w-full flex justify-center py-8 md:py-12",children:e.jsx(F,{})})}export{q as default};
