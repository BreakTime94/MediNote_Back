import{al as B,am as M,a as r,ao as e,an as P}from"./index-D3Bzzjcr.js";function T({noticeCategoryId:k=1,defaultPostStatus:E="PUBLISHED",onCancel:f,onSuccess:h,listPath:n="/boards/notice",readPathBuilder:I=s=>`/boards/notice/read/${s}`}){const s=B(),{member:a,loading:l,fetchMember:u}=M(),x=(a?.role||"").toUpperCase()==="ADMIN";r.useEffect(()=>{!a&&!l&&u&&u()},[a,l,u]),r.useEffect(()=>{!l&&a&&!x&&(alert("관리자만 접근할 수 있습니다."),s(n))},[l,a,x,s,n]);const[o,C]=r.useState(""),[c,D]=r.useState(""),[d,A]=r.useState(!0),[m,H]=r.useState(!1),[y,L]=r.useState(E),[j,N]=r.useState(!1),[v,w]=r.useState(""),i=r.useMemo(()=>{const t={};return(!o||o.trim().length<2)&&(t.title="제목은 2자 이상 입력하세요."),(!c||c.trim().length<10)&&(t.content="내용은 10자 이상 입력하세요."),t},[o,c]),S=Object.keys(i).length>0,U=()=>{if(f)return f();s(n)},q=async t=>{if(t.preventDefault(),!S){if(l){alert("사용자 정보를 확인 중입니다. 잠시 후 다시 시도하세요.");return}if(!a){alert("로그인이 필요합니다."),s(n);return}if(!x){alert("관리자만 공지 등록이 가능합니다."),s(n);return}N(!0),w("");try{const g={boardCategoryId:k,title:o.trim(),content:c.trim(),requireAdminPost:m,isPublic:d,qnaStatus:"WAITING",postStatus:y},b=(await P.post("/boards/register",g))?.data?.id;if(h)return h(b);s(b?I(b):n)}catch(g){const p=g?.response?.status;if(p===401){alert("로그인이 필요합니다."),s("/login");return}if(p===403){alert("관리자 권한이 필요합니다."),s(n);return}w("등록에 실패했습니다. 잠시 후 다시 시도해 주세요.")}finally{N(!1)}}};return e.jsxs("section",{className:"w-full max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"공지 등록"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"새로운 소식/업데이트를 등록하세요."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:U,className:"rounded-2xl px-4 py-2 shadow-sm ring-1 ring-gray-200 bg-white text-gray-700 hover:bg-gray-50 transition",children:"취소"}),e.jsx("button",{type:"submit",form:"notify-write-form",disabled:j||S||!x||l||!a,className:"rounded-2xl px-4 py-2 shadow-sm text-white bg-gradient-to-r from-pink-300 to-purple-300 hover:opacity-90 transition disabled:opacity-60",children:j?"등록 중…":"등록"})]})]}),e.jsxs("form",{id:"notify-write-form",onSubmit:q,className:"rounded-3xl border border-gray-200 bg-white p-5 md:p-6 shadow-sm space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"공개 여부"}),e.jsx("button",{type:"button",onClick:()=>A(t=>!t),className:"w-full px-3 py-2 rounded-xl text-sm ring-1 transition "+(d?"bg-gradient-to-r from-pink-200 to-purple-200 text-gray-900 ring-transparent":"bg-white text-gray-700 ring-gray-200 hover:bg-gray-50"),title:d?"현재: 공개":"현재: 비공개",children:d?"공개":"비공개"}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"비공개 시 관리자만 확인할 수 있습니다."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"게시 상태"}),e.jsxs("select",{value:y,onChange:t=>L(t.target.value),className:"w-full rounded-xl border border-gray-200 text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-200",children:[e.jsx("option",{value:"PUBLISHED",children:"게시(PUBLISHED)"}),e.jsx("option",{value:"HIDDEN",children:"숨김(HIDDEN)"})]}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"게시 선택 시 목록에 노출됩니다. 숨김은 임시 저장 용도로 사용할 수 있습니다."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"중요 공지"}),e.jsx("button",{type:"button",onClick:()=>H(t=>!t),className:"w-full px-3 py-2 rounded-xl text-sm ring-1 transition "+(m?"bg-gradient-to-r from-pink-200 to-purple-200 text-gray-900 ring-transparent":"bg-white text-gray-700 ring-gray-200 hover:bg-gray-50"),title:m?"현재: 중요":"현재: 일반",children:m?"중요":"일반"}),e.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"상단 고정/강조 등에 활용할 수 있습니다."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"제목"}),e.jsx("input",{type:"text",value:o,onChange:t=>C(t.target.value),placeholder:"예) 서비스 업데이트 안내 (v1.2.0)",className:`w-full rounded-xl border text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-200 ${i.title?"border-rose-300":"border-gray-200"}`,maxLength:160}),e.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[i.title?e.jsx("p",{className:"text-xs text-rose-600",children:i.title}):e.jsx("span",{className:"text-xs text-gray-500",children:"2~160자"}),e.jsxs("span",{className:"text-[11px] text-gray-400",children:[o.length,"/160"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"내용"}),e.jsx("textarea",{value:c,onChange:t=>D(t.target.value),placeholder:"업데이트/점검/이벤트 등 공지 본문을 입력하세요.",className:`w-full min-h-[240px] rounded-xl border text-sm px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-200 resize-y ${i.content?"border-rose-300":"border-gray-200"}`}),i.content?e.jsx("p",{className:"mt-1 text-xs text-rose-600",children:i.content}):e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"10자 이상 입력하세요."})]}),v&&e.jsx("div",{className:"rounded-2xl bg-rose-50 text-rose-700 ring-1 ring-rose-200 px-4 py-3 text-sm",children:v})]})]})}export{T as default};
