import{a as r,an as v,am as y,al as P,ao as e}from"./index-D3Bzzjcr.js";import{s as N}from"./commonToast-eM_n8a5E.js";function S(u,m=500){const[t,w]=r.useState(u),[o,l]=r.useState(!1),[a,p]=r.useState(!1),[h,d]=r.useState("");return r.useEffect(()=>{const c=setTimeout(()=>w(u),m);return()=>clearTimeout(c)},[u,m]),r.useEffect(()=>{t&&(p(!0),d(""),v.post("/member/check/password",{password:t}).then(c=>{c.data.available===!0?(l(!0),d("")):(l(!1),d("비밀번호가 일치하지 않습니다."))}).catch(()=>{l(!1),d("서버 오류 또는 비밀번호 불일치")}).finally(()=>{p(!1)}))},[t]),{valid:o,loading:a,error:h}}function B(){const{logout:u}=y(),m=P(),[t,w]=r.useState(""),[o,l]=r.useState({oldPassword:!1,password:!1,passwordCheck:!1}),[a,p]=r.useState({password:"",passwordCheck:""}),{valid:h,loading:d,error:c}=S(t,500),b=a.password&&a.passwordCheck&&a.password===a.passwordCheck,n={length:a.password.length>=8&&a.password.length<=16,number:/[0-9]/.test(a.password),letter:/[a-zA-Z]/.test(a.password),special:/[!@#$%^&*]/.test(a.password),noSpace:!/\s/.test(a.password)},k=s=>{s.preventDefault();const{name:i,value:f}=s.target;o[i]||l(x=>({...x,[i]:!0})),w(f)},g=s=>{s.preventDefault();const{name:i,value:f}=s.target;o[i]||l(x=>({...x,[i]:!0})),p(x=>({...x,[i]:f}))},j=!h||d||c||Object.values(n).some(s=>s.length>0)||!b||t===a.password||!t,C=()=>{v.patch("/member/change/password",a).then(s=>{N.success({title:s.data.status,desc:s.data.message}),u(),m("/member/login")}).catch(s=>{N.error({title:s.data.code,desc:s.data.message}),m("/member/mypage")})};return e.jsx("div",{className:"flex flex-col items-center justify-center bg-white",children:e.jsxs("div",{className:"mb-4 mx-auto bg-white shadow-lg rounded-2xl border p-8 w-full",children:[e.jsx("div",{className:"w-full mb-4",children:e.jsx("h3",{className:"font-bold",children:"비밀번호 변경"})}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"기존 비밀번호"}),e.jsx("input",{id:"oldPassword",name:"oldPassword",type:"password",className:"w-full px-3 py-1 border rounded-lg focus:outline-none",placeholder:"현재 비밀번호를 입력하여주세요.",onChange:k,onBlur:()=>{l(s=>({...s,oldPassword:!0}))}}),o.oldPassword&&e.jsxs("ul",{className:"mt-2 text-xs",children:[d&&e.jsx("li",{className:"text-blue-500",children:"비밀번호 검증중입니다."}),c&&e.jsx("li",{className:"text-red-500",children:"비밀번호가 일치하지 않습니다."}),h&&!c&&!d&&e.jsx("li",{className:"text-blue-500",children:"비밀번호가 일치합니다."})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"신규비밀번호"}),e.jsx("input",{id:"password",name:"password",type:"password",className:" w-full px-3 py-1 border rounded-lg focus:outline-none",placeholder:"변경하실 비밀번호를 입력하여주세요.",onChange:g,onBlur:()=>{l(s=>({...s,password:!0}))}}),t===a.password&&t&&a&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:"기존 비밀번호와 동일하게 설정하실 수 없습니다."})}),o.password&&t!==a.password&&e.jsxs("ul",{className:"mt-2 text-xs",children:[e.jsx("li",{className:o.password&&n.length?"text-blue-500":"text-red-500",children:"비밀번호는 8자 ~ 16자 사이여야 합니다."}),e.jsx("li",{className:n.number?"text-blue-500":"text-red-500",children:"비밀번호는 숫자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:n.letter?"text-blue-500":"text-red-500",children:"비밀번호는 영문자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:n.special?"text-blue-500":"text-red-500",children:"비밀번호는 특수문자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:n.noSpace?"text-blue-500":"text-red-500",children:"비밀번호에는 공백이 포함될 수 없습니다."})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"신규비밀번호 확인"}),e.jsx("input",{id:"passwordCheck",name:"passwordCheck",type:"password",className:" w-full px-3 py-1 border rounded-lg focus:outline-none",placeholder:"변경하실 비밀번호를 다시 입력하여주세요.",onChange:g,onBlur:()=>{l(s=>({...s,passwordCheck:!0}))}}),o.passwordCheck&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:b?"text-blue-500":"text-red-500",children:b?"비밀번호가 일치합니다":"비밀번호가 일치하지 않습니다."})})]}),e.jsx("div",{className:"w-full text-center mt-4",children:e.jsx("button",{type:"submit",className:`flex-1 w-full text-white px-3 py-1 rounded-lg
                       ${j?"bg-gray-400 cursor-not-allowed":"bg-pink-300 hover:bg-pink-400 active:bg-pink-500 cursor-pointer"}`,disabled:j,onClick:C,children:"비밀번호 변경"})})]})})}export{B as default};
