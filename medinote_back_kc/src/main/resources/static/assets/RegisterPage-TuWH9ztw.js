import{ao as e,al as R,a as u,an as U}from"./index-D3Bzzjcr.js";import{U as S}from"./UseDuplicateCheck-CCrvuKal.js";import{u as I}from"./useEmailVerification-BiFkASqM.js";import{T as L}from"./TermsSection-BkNx7g1u.js";import"./useEmailTimer-DN5LH1mw.js";import"./commonToast-eM_n8a5E.js";function M({member:n,touched:p,errors:t,emailStatus:m,handleBlur:i,change:v,verification:l,setVerification:o}){const{verificationCode:b,setVerificationCode:y,showCodeInput:w,setShowCodeInput:C,sendCode:j,verifyCode:d,leftTime:h,formatTime:c}=I();return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"이메일"}),e.jsx("input",{id:"email",name:"email",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 disabled:bg-gray-100",placeholder:"이메일을 입력하세요",onBlur:i,onChange:g=>{v(g),o(!1),C(!1)},value:n.email,disabled:l}),p.email&&!t.email&&m==="available"&&n.email!==n.extraEmail&&!l&&e.jsx("button",{type:"button",className:"mt-2 w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",onClick:()=>j(n.email,"signUp"),children:"인증메일 요청"}),w&&!l&&e.jsxs("div",{className:"mt-2 flex gap-2 items-center",children:[e.jsx("input",{type:"text",name:"verificationCode",placeholder:"인증코드 입력",className:"px-1 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400  disabled:bg-gray-200",disabled:l,value:b,onChange:g=>y(g.target.value)}),h&&e.jsx("span",{className:"text-xs text-gray-500 w-8 font-bold shrink-0",children:c(h)}),e.jsx("button",{type:"button",className:"shrink-0 px-3 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:bg-amber-100",disabled:l,onClick:()=>d(n.email,l,o,"signUp"),children:"확인"})]}),!w&&l&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-blue-500",children:"이메일 인증이 완료되었습니다."})}),p.email&&t.email&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:t.email})}),p.email&&!t.email&&m!=="idle"&&n.email!==n.extraEmail&&!l&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:m==="available"?"text-blue-500":"text-red-500",children:m==="available"?"사용 가능한 이메일입니다.":"사용하실 수 없는 이메일입니다."})}),p.email&&!t.email&&n.email&&n.email===n.extraEmail&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:"추가 이메일과 같은 이메일을 사용하실 수 없습니다."})})]})}function G(n){const p=R(),[t,m]=u.useState({email:"",password:"",extraEmail:"",nickname:""}),[i,v]=u.useState({password:"",passwordCheck:""}),[l,o]=u.useState({email:!1,password:!1,passwordCheck:!1,extraEmail:!1,nickname:!1}),[b,y]=u.useState({service:!1,privacy:!1,marketing:!1}),[w,C]=u.useState([]),j=a=>{const{name:s,value:x}=a.target;o(r=>({...r,[s]:!0})),g(r=>({...r,[s]:d(s,x)}))},d=(a,s)=>{switch(a){case"email":if(!s)return"이메일은 필수입니다.";if(!/^(?!.*\s)[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(s))return"문자 내 공백은 불가하며, 올바른 이메일 형식이어야 합니다. ex) aaa@bbb.ccc 등";break;case"extraEmail":if(!s)return"추가 이메일은 필수입니다.";if(!/^(?!.*\s)[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(s))return"문자 내 공백은 불가하며, 올바른 이메일 형식이어야 합니다. ex) aaa@bbb.ccc 등";break;case"nickname":if(!s)return"닉네임은 필수입니다.";if(!/^(?!.*\s)[가-힣a-zA-Z0-9]{2,16}$/.test(s))return"문자 내 공백은 불가하며, 닉네임은 한글, 영문, 숫자만 사용하여 2~16자까지 가능합니다.";break;default:return""}return""},h=a=>{a.preventDefault();const{name:s,value:x}=a.target;m(r=>({...r,[s]:x})),l[s]||o(r=>({...r,[s]:!0})),g(r=>({...r,[s]:d(s,x)}))},[c,g]=u.useState({}),f={length:i.password.length>=8&&i.password.length<=16,number:/[0-9]/.test(i.password),letter:/[a-zA-Z]/.test(i.password),special:/[!@#$%^&*]/.test(i.password),noSpace:!/\s/.test(i.password)},E=i.password&&i.passwordCheck&&i.password===i.passwordCheck,A=a=>{a.preventDefault();const{name:s,value:x}=a.target;l[s]||o(r=>({...r,[s]:!0})),v(r=>({...r,[s]:x})),m(r=>({...r,[s]:x}))},z=S("email",t.email,"/member/check/email",d),N=S("email",t.extraEmail,"/member/check/email",d),k=S("nickname",t.nickname,"/member/check/nickname",d),[T,$]=u.useState(!1),Z=!E||Object.values(f).some(a=>!a)||Object.values(c).some(a=>a&&a.length>0)||z!=="available"||N!=="available"||k!=="available"||!T||b.privacy===!1||b.service===!1,B={...t,agreements:w.map(a=>({termsId:a.id,agreed:b[a.policyCode]||!1}))},D=a=>{window.confirm("정말 제출하시겠습니까?")&&(a.preventDefault(),U.post("/member/register",B).then(s=>{console.log("Content-Type",s.headers["content-type"]),p("/member/login")}).catch(s=>{console.log("error",s)}))};return e.jsx("div",{className:"w-full flex-1 flex justify-center items-center bg-white pt-16",children:e.jsxs("div",{className:"mx-auto bg-white shadow-lg rounded-2xl border p-8 w-96",children:[e.jsx(M,{member:t,touched:l,errors:c,emailStatus:z,handleBlur:j,change:h,verification:T,setVerification:$}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비밀번호"}),e.jsx("input",{id:"password",name:"password",type:"password",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"비밀번호를 입력하세요",onBlur:()=>{o(a=>({...a,password:!0}))},onChange:A}),l.password&&e.jsxs("ul",{className:"mt-2 text-xs",children:[e.jsx("li",{className:l.password&&f.length?"text-blue-500":"text-red-500",children:"비밀번호는 8자 ~ 16자 사이여야 합니다."}),e.jsx("li",{className:f.number?"text-blue-500":"text-red-500",children:"비밀번호는 숫자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:f.letter?"text-blue-500":"text-red-500",children:"비밀번호는 영문자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:f.special?"text-blue-500":"text-red-500",children:"비밀번호는 특수문자를 1개이상 포함하여야 합니다."}),e.jsx("li",{className:f.noSpace?"text-blue-500":"text-red-500",children:"비밀번호에는 공백이 포함될 수 없습니다."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"비밀번호 확인"}),e.jsx("input",{id:"passwordCheck",name:"passwordCheck",type:"password",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"위에 입력하신 비밀번호를 입력하여주세요.",onBlur:()=>{o(a=>({...a,passwordCheck:!0}))},onChange:A}),l.passwordCheck&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:E?"text-blue-500":"text-red-500",children:E?"비밀번호가 일치합니다":"비밀번호가 일치하지 않습니다."})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"추가이메일"}),e.jsx("input",{id:"extraEmail",name:"extraEmail",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"추가 이메일을 입력하여주세요.",onBlur:j,onChange:h}),l.extraEmail&&c.extraEmail&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:c.extraEmail})}),l.extraEmail&&!c.extraEmail&&N!=="idle"&&t.email!==t.extraEmail&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:N==="available"?"text-blue-500":"text-red-500",children:N==="available"?"사용 가능한 이메일입니다.":"사용하실 수 없는 이메일입니다."})}),l.extraEmail&&!c.extraEmail&&t.extraEmail===t.email&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:"로그인용 이메일과 같은 이메일을 사용하실 수 없습니다."})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"닉네임"}),e.jsx("input",{id:"nickname",name:"nickname",className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"닉네임을 입력하세요",onBlur:j,onChange:h}),l.nickname&&c.nickname&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:"text-red-500",children:c.nickname})}),l.nickname&&!c.nickname&&k!=="idle"&&e.jsx("ul",{className:"mt-2 text-xs",children:e.jsx("li",{className:k==="available"?"text-blue-500":"text-red-500",children:k==="available"?"사용 가능한 닉네임입니다.":"사용하실 수 없는 닉네임입니다."})})]}),e.jsx(L,{agreements:b,setAgreements:y,onTermsLoaded:C}),e.jsx("div",{className:"flex gap-2 mt-2",children:e.jsx("button",{type:"submit",className:`flex-1  text-white py-2 rounded-lg
                       ${Z?"bg-gray-400 cursor-not-allowed":"bg-pink-300 hover:bg-pink-400 active:bg-pink-500 cursor-pointer"}`,disabled:Z,onClick:D,children:"제출하기"})})]})})}export{G as default};
